<h1>{{product.title}}</h1>
<p>{{product.description}}</p>
<p>Precio: ${{product.price}}</p>
<p>Categoria: {{product.category}}</p>
<form action="/api/carts" method="post" id="createCartForm">
  <button type="button" id="addToCartBtn">Agregar al carrito (crea uno si no existe)</button>
</form>
<script>
document.getElementById('addToCartBtn').addEventListener('click', async () => {
  // create a cart then add product
  const res = await fetch('/api/carts', { method: 'POST' });
  const data = await res.json();
  if (data.status === 'success') {
    const cid = data.payload.id;
    await fetch(`/api/carts/${cid}/product/{{product.id}}`, { method: 'POST' });
    alert('Agregado al carrito: ' + cid);
    window.location.href = '/carts/' + cid;
  } else alert('Error');
});
</script>
